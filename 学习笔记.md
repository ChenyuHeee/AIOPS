# 学习笔记

## 1. AI Agent 项目的通用启发
- **任务拆解与角色设计**：这套 AIOps 流程把“异常检测→故障分类→根因定位→反思→总结”拆成多个专职智能体，证明多智能体并不等于“多模型”，而是“多角色 + 明确的输入输出协议”。这一思路可迁移到其它领域（内容审核、代码审查、问诊等）。
- **统一消息契约**：`agent/agent.py` 给每个智能体都定义了系统提示、能力描述和期望输出（尤其是最终 JSON schema）。提前约定契约，让不同模型或版本替换时仍能无缝衔接。
- **闭环控制与自检**：引入 Reflection/Summarization 形成“自我纠错 + 最终审定”机制，降低单轮回答失误的概率。这种 pattern 在任何高风险输出场景都适用。

## 2. Prompt 与上下文管理技巧
- **注入业务上下文**：通过提示词列出节点/服务/Pod 名称、链路拓扑、KPI 命名要求，使模型答案对齐业务语义；以后在别的项目中，也可把“关键实体/规则”当作提示词的一部分反复强调。
- **结构化输出约束**：所有需要评分或提交的平台，都要求严格 JSON；此项目把字段解释、字数限制、英文输出等要求写进 prompt，可直接复用到其它评测型任务。
- **多模态摘要**：在进入多智能体协作之前，先让 Logs/Metrics/Traces Agent 各自“压缩”输入，降低上下文长度。这种“先局部提炼、再全局推理”的思路适用于任何需要融合多数据源的 Agent。

## 3. 多智能体编排最佳实践
- **GraphFlow 有向图**：用图来描述“谁先说话”“谁依赖谁”，比简单的回合轮询更直观。类似框架也能迁移到客服流水线、自动化报告生成等任务。
- **可控终止条件**：`MaxMessageTermination` 等机制能防止对话无限循环；实际项目里，只要给每个节点定义“触发条件”和“终止条件”，就能保持系统稳定。
- **数据证据链**：在 `main.py` 中，每次调用 Agent 前都构造 multimodal prompt，明确“日志/指标/Trace 哪些部分最关键”，相当于向模型提供“证据链”。以后设计其它 Agent 时，也要记得把证据显式列出，避免模型只靠幻想。

## 4. 数据侧的最低保障（简记）
- 确保日志/指标/Trace 至少有统一的 `timestamp_ns`，才方便对齐窗口；脚本里通过 `raw_*_processor.py` 做这一步，虽然不是核心竞争力，但属于所有 AI Agent 项目的“地基”。
- 预处理脚本支持参数化目录与并行处理，这些工程技巧能复用到任何需要批量清洗数据的场景。

## 5. 想继续深入的主题
- 研究 IsolationForest + Trace 的组合：正常样本抽取、滑动窗口特征、异常阈值如何调参，未来可以套用到其它链路分析类项目。
- 探索如何把反思/反馈机制自动化，例如基于 Reflection 的输出动态调整 prompt，形成“自适应提示词”。
- 评估多智能体框架在其它行业的迁移路径，比如将 AD/FT/RCL 换成“需求理解/方案生成/风险审查”等角色。
